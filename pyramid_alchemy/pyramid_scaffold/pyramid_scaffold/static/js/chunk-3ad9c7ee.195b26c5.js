(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ad9c7ee"],{"7f7f":function(t,e,n){var i=n("86cc").f,a=Function.prototype,o=/^\s*function ([^ (]*)/,s="name";s in a||n("9e1e")&&i(a,s,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},ee92:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-container",[n("b-modal",{attrs:{id:"roomSelectModal",title:"Выберите комнату"},on:{ok:t.onModalOk}},[n("p",{staticClass:"my-4"},[t._v("Выберите отделение и комнату для госпитализации:")]),n(t.dynamicDepartmentList,{tag:"component"})],1),n("b-row",[n("b-col",[n("b-row",{staticClass:"mb-2"},[n("b-col",[n("h2",{attrs:{for:"example-datepicker"}},[t._v("Введите шаблон:")])])],1),n("b-row",{staticClass:"mb-2"},[n("b-col",[n("b-button",{on:{click:t.goToPatientEditPage}},[t._v("Изменить данные")])],1),n("b-col",[n("b-button",{on:{click:t.goToAddInvest}},[t._v("Добавить исследование")])],1),n("b-col",[n("b-button",{on:{click:t.addEmptyInvest}},[t._v("Консультация (чистая)")])],1)],1),n("b-row",{staticClass:"mb-2"},[n("b-col",[n("b-button",{on:{click:t.deletePatient}},[t._v("Удалить пациента")])],1),n("b-col",[this.inPatient.id||null!=this.inPatient.discharged&&!this.inPatient.discharged?n("b-button",{on:{click:t.setInPatientDischarged}},[t._v("Выписать")]):n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.roomSelectModal",modifiers:{roomSelectModal:!0}}]},[t._v("Госпитализировать")])],1),n("b-col",[n("b-button",{on:{click:t.goToPatientsList}},[t._v("Список пациентов")])],1)],1),n("b-row",[n("b-overlay",{attrs:{show:t.loading,rounded:"sm"}},[n("b-table",{attrs:{id:"invests-table",items:t.items,fields:t.fields,selectable:"","select-mode":"single"},on:{"row-selected":t.clickList}}),n("b-pagination",{attrs:{"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"invests-table"},on:{input:function(e){return t.fetchData(this.id,t.currentPage)}},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)],1),n("b-col",[n("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var i=e.handleSubmit;return[n("b-form",{on:{submit:function(e){return e.preventDefault(),i(t.onSubmit)}}},[n("b-row",{staticClass:"mb-2"},[n("b-col",{attrs:{md:"12"}},[n("validation-provider",{attrs:{rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[n("b-form-input",{attrs:{placeholder:"Название"},model:{value:t.editedInvest.name,callback:function(e){t.$set(t.editedInvest,"name",e)},expression:"editedInvest.name"}}),n("span",{staticClass:"validationError"},[t._v(t._s(i[0]))])]}}],null,!0)})],1)],1),n("b-row",{staticClass:"mb-2"},[n("b-col",{staticClass:"mb-2",attrs:{md:"12"}},[n("label",{attrs:{for:"examinationDate-datepicker"}},[t._v("Дата исследования:")]),n("validation-provider",{attrs:{rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[n("b-form-datepicker",{staticClass:"mb-2",attrs:{locale:"ru",id:"examinationDate-datepicker"},model:{value:t.editedInvest.examinationDate,callback:function(e){t.$set(t.editedInvest,"examinationDate",e)},expression:"editedInvest.examinationDate"}}),n("span",{staticClass:"validationError"},[t._v(t._s(i[0]))])]}}],null,!0)})],1)],1),n("b-row",{staticClass:"mb-2"},[n("b-col",{staticClass:"mb-2",attrs:{md:"12"}},[n("b-form-textarea",{attrs:{id:"textarea",placeholder:"Шаблон",rows:"8","max-rows":"10"},model:{value:t.editedInvest.contents,callback:function(e){t.$set(t.editedInvest,"contents",e)},expression:"editedInvest.contents"}})],1)],1),n("b-row",{staticClass:"mb-2"},[n("b-col",{attrs:{md:"12"}},[n("label",[t._v("Врач:  ")]),n("b-form-select",{attrs:{options:t.doctors},model:{value:t.editedInvest.physicianId,callback:function(e){t.$set(t.editedInvest,"physicianId",e)},expression:"editedInvest.physicianId"}})],1)],1),n("b-row",{staticClass:"mb-2"},[n("b-col",{attrs:{md:"3"}},[n("b-button",{attrs:{type:"submit"}},[t._v("Сохранить изменения")])],1),n("b-col",{attrs:{md:"2"}},[n("b-button",{on:{click:t.onDeleteInvest}},[t._v("Удалить")])],1),n("b-col",{attrs:{md:"1"}},[n("b-button",{on:{click:t.onPrintInvest}},[t._v("Распечатать")])],1)],1)],1)]}}])})],1)],1)],1),n("router-view")],1)},a=[],o=(n("8e6e"),n("456d"),n("7f7f"),n("ac6a"),n("bd86")),s=n("7bb1"),r=n("4c93"),c=n("5ce5"),d=n("a49b");function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){Object(o["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}Object(s["c"])("required",u(u({},r["a"]),{},{message:"Обязательное поле"}));var m={name:"patient",components:{ValidationProvider:s["b"],ValidationObserver:s["a"]},created:function(){this.id=this.$route.query.id,this.fetchData(this.id,1),this.fetchDoctorsData()},methods:{deletePatient:function(){var t=this;c["i"].delete(this.id).then((function(e){t.goToPatientsList(),console.log(e)}))},setInPatientDischarged:function(){var t=this;this.inPatient.discharged=!0,c["i"].setInPatientDischarged(this.inPatient).then((function(e){t.fetchData(t.id,t.currentPage),console.log(e)}))},getDepartmentIdByRoomId:function(t){var e=null;return this.departments.forEach((function(n){n.rooms.length>0&&n.rooms.forEach((function(i){t==i.id&&(e=n.id)}))})),e},onModalOk:function(){var t=this,e=document.getElementsByName("room");e.forEach((function(e){e.checked&&(t.modalRoom=e.value,t.inPatient.discharged=!0,c["i"].addInPatient({patientId:parseInt(t.id),roomId:parseInt(e.value),departmentId:t.getDepartmentIdByRoomId(e.value)}).then((function(e){t.fetchData(t.id,t.currentPage),console.log(e)})))}))},renderDepartmentList:function(t){if(null==t)return"";var e="",n=1;return t.forEach((function(t){null!=t.rooms&&t.rooms.length>0&&(e+="<a>"+t.name+":</a><br>",t.rooms.forEach((function(t){e+='<input type="radio" v-model="modalRoom" id="room'+n+'" name="room" value="'+t.id+'"> <label for="room'+n+'">'+t.name+"</label><br>"})),e+="<br>")})),e},fetchData:function(t,e){var n=this;this.loading=!0,c["i"].getInvests(e||1,t).then((function(t){n.itemst=t.data.items,n.rows=t.data.totalItems,n.perPage=t.data.per_page,n.loading=(!1).data})),c["i"].getDepartments().then((function(t){n.departments=t.data.departments})),c["i"].getInPatient(t).then((function(t){n.inPatient=t.data}))},clickList:function(t,e,n){console.log(t+e+n),this.editedInvest.id=t[0].id,this.editedInvest.name=t[0].name,this.editedInvest.contents=t[0].contents,this.editedInvest.examinationDate=t[0].examinationDate,this.editedInvest.physicianId=t[0].physicianId},goToAddInvest:function(){this.$router.push({path:"AddInvest",query:{patientId:this.id}})},goToPatientEditPage:function(){this.$router.push({path:"editPatient",query:{id:this.id}})},goToPatientsList:function(){this.$router.push("patients")},addEmptyInvest:function(){var t=this;c["i"].addEmptyInvest(this.id).then((function(e){t.fetchData(t.id,t.currentPage),console.log(e)}))},onPrintInvest:function(){window.location=d["a"]+"printExamination?examinationId="+this.editedInvest.id},onSubmit:function(){var t=this;c["i"].updateInvest(this.$data.editedInvest).then((function(e){t.fetchData(t.id,t.currentPage),console.log(e)}))},onDeleteInvest:function(){var t=this;c["i"].deleteExamination(this.editedInvest.id).then((function(e){t.fetchData(t.id,t.currentPage),console.log(e)}))},fetchDoctorsData:function(){var t=this;c["i"].getDoctors().then((function(e){e.data.physicians.forEach((function(e){e.text=e.family+" "+e.name.substring(0,1).toUpperCase()+". "+e.thirdName.substring(0,1).toUpperCase()+".",e.value=e.id,t.doctors.push(e)}))}))}},computed:{dynamicDepartmentList:function(){return{template:"<div>".concat(this.renderDepartmentList(this.departments),"</div>"),methods:{someAction:function(){console.log("Action!")}}}},items:function(){var t=[];return this.itemst.forEach((function(e){e.physician&&(e.physician.fio=e.physician.family+" "+e.physician.name.substring(0,1).toUpperCase()+". "+e.physician.thirdName.substring(0,1).toUpperCase()+"."),t.push(e)})),t}},data:function(){return{id:null,loading:!1,rows:0,perPage:20,currentPage:1,departments:null,modalRoom:null,inPatient:null,fields:[{key:"name",label:"Исследование"},{key:"examinationDate",label:"Дата"},{key:"physician.fio",label:"Врач"}],editedInvest:{id:null,name:null,examinationDate:null,contents:null,physicianId:null},doctors:[{value:null,text:"Выберите врача"}],itemst:null}}},b=m,h=n("2877"),p=Object(h["a"])(b,i,a,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-3ad9c7ee.195b26c5.js.map